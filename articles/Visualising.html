<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Visualising the output of Monte Carlo methods with ggsmc • ggsmc</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Visualising the output of Monte Carlo methods with ggsmc">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ggsmc</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.2.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Visualising.html">Visualising the output of Monte Carlo methods with ggsmc</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/richardgeveritt/ggsmc/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Visualising the output of Monte Carlo methods with ggsmc</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/richardgeveritt/ggsmc/blob/main/vignettes/Visualising.Rmd" class="external-link"><code>vignettes/Visualising.Rmd</code></a></small>
      <div class="d-none name"><code>Visualising.Rmd</code></div>
    </div>

    
    
<p>The <code>ggsmc</code> package uses <code>ggplot2</code> to display
the results of importance sampling (IS), sequential Monte Carlo (SMC) or
ensemble-based algorithms. Each algorithm outputs a collection of
points, usually evolved through a sequence of target distributions,
which for IS and SMC are weighted.</p>
<div class="section level2">
<h2 id="data-format">Data format<a class="anchor" aria-label="anchor" href="#data-format"></a>
</h2>
<p>To use this package the algorithm output must be in <a href="https://r4ds.had.co.nz/tidy-data.html" class="external-link">tidy format</a>, where each
dimension of each parameter for each particle lies in a distinct row in
a data frame. The data <code>sir_cwna_model</code> provides an example
of valid input to the plotting functions.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/richardgeveritt/ggsmc" class="external-link">ggsmc</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">sir_cwna_model</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sir_cwna_model</span><span class="op">)</span></span>
<span><span class="co">#&gt;   ExternalIndex Target      Time NormalisingConstant   ISESS TargetParameters</span></span>
<span><span class="co">#&gt; 1             1      1 0.0025475            -3.07181 16.2299        i=0;dt=1;</span></span>
<span><span class="co">#&gt; 2             1      1 0.0025475            -3.07181 16.2299        i=0;dt=1;</span></span>
<span><span class="co">#&gt; 3             1      1 0.0025475            -3.07181 16.2299        i=0;dt=1;</span></span>
<span><span class="co">#&gt; 4             1      1 0.0025475            -3.07181 16.2299        i=0;dt=1;</span></span>
<span><span class="co">#&gt; 5             1      1 0.0025475            -3.07181 16.2299        i=0;dt=1;</span></span>
<span><span class="co">#&gt; 6             1      1 0.0025475            -3.07181 16.2299        i=0;dt=1;</span></span>
<span><span class="co">#&gt;   Iteration Particle AncestorIndex  LogWeight ParameterName Dimension    Value</span></span>
<span><span class="co">#&gt; 1         1        1             1 -28.057199             x         1   6.5297</span></span>
<span><span class="co">#&gt; 2         1        1             1 -28.057199             x         2 -15.4264</span></span>
<span><span class="co">#&gt; 3         1        2             2  -2.453099             x         1  -0.5869</span></span>
<span><span class="co">#&gt; 4         1        2             2  -2.453099             x         2  -8.7790</span></span>
<span><span class="co">#&gt; 5         1        3             3 -11.568199             x         1   3.6434</span></span>
<span><span class="co">#&gt; 6         1        3             3 -11.568199             x         2 -14.1641</span></span></code></pre></div>
<p>This data contains the output of a particle filter (PF) applied to a
target tracking problem. The state
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">x=(x_1,x_2)^T</annotation></semantics></math>
tracked using the PF is two-dimensional, consisting of the
(one-dimensional) position and velocity of the target. The value of the
first particle for the first target distribution is given by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>T</mi></msup><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>3.0163</mn><mo>,</mo><mn>4.6682</mn><mo stretchy="true" form="postfix">)</mo></mrow><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">(x_1,x_2)^T=(3.0163,4.6682)^T</annotation></semantics></math>.
In tidy format, this is stored on two rows of the data frame, where the
<code>Dimension</code> column gives the index of the state
<code>ParameterName</code>: e.g. in the row where
<code>ParameterName=="x"</code> and <code>Dimension==2</code>, the
<code>Value</code> column gives the value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mn>2</mn></msub><annotation encoding="application/x-tex">x_2</annotation></semantics></math>.</p>
<p>If you are unfamiliar with it, this way of storing data with its many
repeated values might seem wasteful. Its strength is that this format
can be used consistently across different situations, allowing the use
of general purpose packages for processing and, in our case, plotting
the data. If your data is in the more standard matrix format for Monte
Carlo output (i.e. one parameter vector per row), then you can use the
<code>matrix2tidy</code> function included in the package to convert to
the required format your algorithm output for each target distribution.
For this function you need to supply your algorithm <code>output</code>
in matrix format, a name for the <code>parameter</code> that is
represented in the output, an integer index for the <code>target</code>
to which the output corresponds and the <code>log_weights</code> of each
particle if using an IS or SMC algorithm. If using an algorithm that
iterates over multiple targets, the <code>matrix2tidy</code> function
should be called for each target, then the output of each call stacked
together using <code>rbind</code>.</p>
<p>The <code>sir_cwna_model</code> data contains more columns than are
required to use the plotting functions in this package. The columns
required by all functions are:</p>
<ul>
<li><p><code>Target</code>, which indexes the target distribution,
taking a different integer values for each target.</p></li>
<li><p><code>Particle</code>, which indexes the particles, taking a
different integer value for each particle.</p></li>
<li><p><code>ParameterName</code>, which uses a string to name each
parameter.</p></li>
<li><p><code>Dimension</code>, which indexes the dimension of the
parameter, taking a different integer value for each dimension.</p></li>
<li><p><code>Value</code>, which stores the numerical value for the
particle, target, parameter and dimension specified by the other
columns.</p></li>
</ul>
<p>For the output of an IS or SMC algorithm, we may additionally include
a <code>LogWeight</code> column to store the log of the (normalised)
weight of the particle. If this column is not found in the data, each
particle will be assigned an equal weight.</p>
</div>
<div class="section level2">
<h2 id="histograms-and-densities">Histograms and densities<a class="anchor" aria-label="anchor" href="#histograms-and-densities"></a>
</h2>
<p>The <code>plot_histogram</code> and <code>plot_density</code>
functions may be used to plot, respectively, a histogram or density of
the marginal distribution of one dimension of one parameter. If the
<code>LogWeight</code> column is present in the data a weighted
histogram/density will be used.</p>
<p>For these functions, a <code>parameter</code> (string) and
<code>dimension</code> (integer) argument need to be used. If the
<code>target</code> variable is set, the function will plot the marginal
histogram/density for the specified target, parameter and dimension. If
no target is specified, the points for all points for the specified
parameter and dimension will be used for the plot. The
<code>plot_histogram</code> function also takes a <code>bins</code>
argument, which may be used to specify the number of bins for the
histogram (if this argument is not specified, the default value in
<code>ggplot2</code> is used).</p>
<p>For an example, we look at the 20th target of the
<code>sir_cwna_model</code> data using both a histogram and a
density.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_histogram.html">plot_histogram</a></span><span class="op">(</span><span class="va">sir_cwna_model</span>,</span>
<span>               parameter <span class="op">=</span> <span class="st">"x"</span>,</span>
<span>               dimension <span class="op">=</span> <span class="fl">1</span>,</span>
<span>               target <span class="op">=</span> <span class="fl">20</span>,</span>
<span>               bins <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></code></pre></div>
<p><img src="Visualising_files/figure-html/histogram-1.png" width="639.999936"></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_density.html">plot_density</a></span><span class="op">(</span><span class="va">sir_cwna_model</span>,</span>
<span>             parameter <span class="op">=</span> <span class="st">"x"</span>,</span>
<span>             dimension <span class="op">=</span> <span class="fl">1</span>,</span>
<span>             target <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></code></pre></div>
<p><img src="Visualising_files/figure-html/density-1.png" width="639.999936"></p>
</div>
<div class="section level2">
<h2 id="scatter-plots">Scatter plots<a class="anchor" aria-label="anchor" href="#scatter-plots"></a>
</h2>
<p>The <code>plot_scatter</code> function can we used to creates a
scatter plot of the Monte Carlo representation of the joint distribution
between two parameters, or two dimensions of the same parameter. We
specify the parameter and dimension for the x-axis using the arguments
<code>x_parameter</code> and <code>x_dimension</code> respectively. The
<code>target</code> variable plays the same role as for
<code>plot_histogram</code> and <code>plot_density</code>. If a
<code>LogWeight</code> column is present in the data, the size of the
points in the scatter plot will be used to represent the particle
weights.</p>
<p>We illustrate this plot again on the 20th target of the
<code>sir_cwna_model</code> data.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_scatter.html">plot_scatter</a></span><span class="op">(</span><span class="va">sir_cwna_model</span>,</span>
<span>             x_parameter <span class="op">=</span> <span class="st">"x"</span>,</span>
<span>             x_dimension <span class="op">=</span> <span class="fl">1</span>,</span>
<span>             y_parameter <span class="op">=</span> <span class="st">"x"</span>,</span>
<span>             y_dimension <span class="op">=</span> <span class="fl">2</span>,</span>
<span>             target <span class="op">=</span> <span class="fl">20</span>,</span>
<span>             alpha <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>             max_size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="Visualising_files/figure-html/scatter-1.png" width="639.999936"></p>
<p>Note that in this plot we have used two additional arguments,
<code>alpha</code> and <code>max_size</code>, to adjust the look of the
plot. In this example we have very few importance points, I found the
default value of <code>alpha = 0.1</code> (the transparency of the
points from 0 to 1) to be too low, and the default
<code>max_size = 1</code> (governing the size of the points) to be too
small.</p>
</div>
<div class="section level2">
<h2 id="genealogies">Genealogies<a class="anchor" aria-label="anchor" href="#genealogies"></a>
</h2>
<p>To more clearly understand the output of an SMC or ensemble-based
algorithm it can be useful to visualise the evolution of the particles
over time. The function <code>plot_genealogy</code> may be used for this
purpose, for one dimension of one parameter. We again use the
<code>sir_cwna_model</code> data to illustrate this function, showing
the evolution of the PF’s estimate of the target position over time.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_genealogy.html">plot_genealogy</a></span><span class="op">(</span><span class="va">sir_cwna_model</span>,</span>
<span>               parameter <span class="op">=</span> <span class="st">"x"</span>,</span>
<span>               dimension <span class="op">=</span> <span class="fl">1</span>,</span>
<span>               use_initial_points <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>               vertical <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>               alpha_lines <span class="op">=</span> <span class="fl">0</span>,</span>
<span>               alpha_points <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>               arrows <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="Visualising_files/figure-html/genealogy-1.png" width="639.999936"></p>
<p>The first few arguments are the same as those used for the
<code>plot_density</code> function. We have used several additional
arguments the alter the plot:</p>
<ul>
<li><p><code>use_initial_points</code> (default TRUE) governs the
inclusion (or otherwise) of the initial unweighted points drawn from the
proposal used to initialise the algorithm. In this case we chose to omit
these points so that we show only the estimate of the <a href="https://en.wikipedia.org/wiki/Particle_filter#The_filtering_problem" class="external-link">filtering
distribution</a> at each time.</p></li>
<li><p><code>vertical</code> (default TRUE) controls the orientation of
the figure.</p></li>
<li><p><code>alpha_lines</code> changes the transparency (from 0,
transparent, to 1, solid) of the lines connecting corresponding points
between successive targets. Here we choose to omit these lines by making
them invisible.</p></li>
<li><p><code>alpha_points</code> changes the transparency (from 0,
transparent, to 1, solid) of the points (whose size is given by the
<code>LogWeights</code> column if included in the data.</p></li>
<li><p><code>arrows</code> (default TRUE) determines if arrows are
included on the lines in the plot (omitted in this plot).</p></li>
</ul>
<p>To illustrate an alternative configuration of a genealogy plot, we
use output from a different algorithm: an <a href="https://www.stats.ox.ac.uk/~doucet/delmoral_doucet_jasra_sequentialmontecarlosamplersJRSSB.pdf" class="external-link">SMC
sampler</a> applied to a sequence of targets on parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
that begins with a Gaussian distribution, and ends with a two-component
mixture of Gaussians.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">mixture_25_particles</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_genealogy.html">plot_genealogy</a></span><span class="op">(</span><span class="va">mixture_25_particles</span>,</span>
<span>               parameter <span class="op">=</span> <span class="st">"θ"</span>,</span>
<span>               dimension <span class="op">=</span> <span class="fl">1</span>,</span>
<span>               alpha_lines <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>               alpha_points <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span></span></code></pre></div>
<p><img src="Visualising_files/figure-html/genealogy2-1.png" width="639.999936"></p>
<p>For an SMC algorithm, due to the <a href="https://en.wikipedia.org/wiki/Particle_filter#Sequential_Importance_Resampling_(SIR)" class="external-link">resampling
step</a> the index of the ancestor of particle
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
for each target is not likely to be
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>.
To produce a plot with lines that connect each particle with its
ancestor, we need an additional column in the data named
<code>AncestorIndex</code>.</p>
</div>
<div class="section level2">
<h2 id="time-series">Time series<a class="anchor" aria-label="anchor" href="#time-series"></a>
</h2>
<p>For some algorithms each Monte Carlo point represents a time series,
where the index that thus far has been represented by the column
<code>Dimension</code> can be thought of as indexing time. To illustrate
this we plot simulations from a stochastic <a href="https://en.wikipedia.org/wiki/Lotka%E2%80%93Volterra_equations" class="external-link">Lotka-Volterra
model</a> produced during a run of an <a href="https://en.wikipedia.org/wiki/Approximate_Bayesian_computation" class="external-link">approximate
Bayesian computation (ABC)</a> algorithm. These are contained in the
data <code>lv_output</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">lv_output</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_time_series.html">plot_time_series</a></span><span class="op">(</span><span class="va">lv_output</span>,</span>
<span>                 parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"X"</span>,<span class="st">"Y"</span><span class="op">)</span>,</span>
<span>                 alpha <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                 ylimits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">600</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Visualising_files/figure-html/time_series-1.png" width="639.999936"></p>
<p>In this plot the weight (given by <code>LogWeight</code>) of each
time series is represented by the width the line. We make the lines more
visible by choosing <code>alpha = 0.5</code> compared to the default
0.1, and change the limits of the y-axis by using
<code>ylimits=c(0,1000)</code>. There is only one target, so the
<code>target</code> argument does not need to be specified. The
<code>max_line_width</code> argument (not used here) can be used to
scale the width of all lines in the plot.</p>
</div>
<div class="section level2">
<h2 id="modifying-figures">Modifying figures<a class="anchor" aria-label="anchor" href="#modifying-figures"></a>
</h2>
<p>All figures are created using <code>ggplot2</code>, so can be
modified using other functions from this package. We now demonstrate
this by adding the true target position onto a plot of the
<code>sir_cwna_model</code> data, and changing its style. We also
demonstrate the ability to automatically generate a title for the
figure.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">cwna_data</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_genealogy.html">plot_genealogy</a></span><span class="op">(</span><span class="va">sir_cwna_model</span>,</span>
<span>               parameter <span class="op">=</span> <span class="st">"x"</span>,</span>
<span>               dimension <span class="op">=</span> <span class="fl">1</span>,</span>
<span>               use_initial_points <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>               vertical <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>               alpha_lines <span class="op">=</span> <span class="fl">0</span>,</span>
<span>               alpha_points <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>               arrows <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>               default_title <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">cwna_data</span>,<span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Index</span>,y<span class="op">=</span><span class="va">Position</span><span class="op">)</span>,colour<span class="op">=</span><span class="st">"red"</span>,inherit.aes <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Visualising_files/figure-html/modified_genealogy-1.png" width="639.999936"></p>
</div>
<div class="section level2">
<h2 id="animating-plots">Animating plots<a class="anchor" aria-label="anchor" href="#animating-plots"></a>
</h2>
<p>The histogram, density, scatter and time series plots can all be
animated, to show how the output changes over a sequence of target
distributions. Below we show the code for generating (looping) 10 second
animations (set by the <code>duration</code> argument) showing how the
<code>sir_cwna_model</code> data changes over the sequence of 20
targets.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/animate_histogram.html">animate_histogram</a></span><span class="op">(</span><span class="va">sir_cwna_model</span>,</span>
<span>                  parameter <span class="op">=</span> <span class="st">"x"</span>,</span>
<span>                  dimension <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                  bins <span class="op">=</span> <span class="fl">20</span>,</span>
<span>                  duration <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/animate_density.html">animate_density</a></span><span class="op">(</span><span class="va">sir_cwna_model</span>,</span>
<span>                parameter <span class="op">=</span> <span class="st">"x"</span>,</span>
<span>                dimension <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                duration <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/animate_scatter.html">animate_scatter</a></span><span class="op">(</span><span class="va">sir_cwna_model</span>,</span>
<span>                x_parameter <span class="op">=</span> <span class="st">"x"</span>,</span>
<span>                x_dimension <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                y_parameter <span class="op">=</span> <span class="st">"x"</span>,</span>
<span>                y_dimension <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                alpha <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                max_size <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                duration <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<p>For time series, there are two possible animations. One,
<code>animate_time_series</code>, shows how the time series particles
evolve over a sequence of (non-time ordered) targets. The other,
<code>animate_reveal_time_series</code>, illustrated below on
<code>lv_output</code>, animates the time series to show how the
population of particles evolves over time.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">`lv_output`</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/animate_reveal_time_series.html">animate_reveal_time_series</a></span><span class="op">(</span><span class="va">lv_output</span>,</span>
<span>                           parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"X"</span>,<span class="st">"Y"</span><span class="op">)</span>,</span>
<span>                           alpha <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                           ylimits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">600</span><span class="op">)</span>,</span>
<span>                           duration <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Richard G Everitt.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
